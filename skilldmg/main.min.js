var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(c){return c.raw=c};$jscomp.createTemplateTagFirstArgWithRaw=function(c,b){c.raw=b;return c};$jscomp.arrayIteratorImpl=function(c){var b=0;return function(){return b<c.length?{done:!1,value:c[b++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};
$jscomp.makeIterator=function(c){var b="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];if(b)return b.call(c);if("number"==typeof c.length)return $jscomp.arrayIterator(c);throw Error(String(c)+" is not an iterable or ArrayLike");};window.onload=initialize;var fSkills;HTMLElement.prototype.setAttributes=function(){if(0<arguments.length&&0==arguments.length%2)for(var c=0;arguments.length>c;c+=2)this.setAttribute(arguments[c],arguments[c+1])};
Array.prototype.suffix=function(c){for(var b=[],a=$jscomp.makeIterator(this),d=a.next();!d.done;d=a.next())b.push(d.value+c);return b};function readFile(c,b){var a=new FileReader;a.readAsText(c.target.files[0]);a.onload=function(d,f,g){return d(f,g)}.bind(null,b,c)}function getSkill(c){return isNaN(c)?fSkills[c]:Object.values(fSkills)[parseInt(c)]}
function fillSkills(){var c=document.getElementById("skills");c.innerHTML="";for(var b in fSkills){var a=fSkills[b],d=document.createElement("option");d.setAttributes("value",a.Id,"name",b);d.innerText=b;d.addEventListener("mouseup",handleSkOpt.bind(d),!1);"0"==a.Id&&d.setAttribute("selected","");c.appendChild(d)}}function handleSkOpt(){fSkills&&doSkillCalc(this.value,!0)}
function handleCalcInp(c){fSkills&&/^-?(0|[1-9]\d*)(\.\d+)?$/.test(c.target.value)&&doSkillCalc(document.getElementById("skills").value,!1)}
function doSkillCalc(c,b){void 0==c&&(c=0);void 0==b&&(b=!0);var a=getSkill(c),d=document.getElementById("dtypes"),f=document.getElementById("sklvl").value,g=document.getElementById("syndmg").value;""==a.EType&&b?(d.value="phys",document.getElementById("mind").value=a.MinDam,document.getElementById("midlv1").value=a.MinLevDam1,document.getElementById("midlv2").value=a.MinLevDam2,document.getElementById("midlv3").value=a.MinLevDam3,document.getElementById("midlv4").value=a.MinLevDam4,document.getElementById("midlv5").value=
a.MinLevDam5,document.getElementById("maxd").value=a.MaxDam,document.getElementById("madlv1").value=a.MaxLevDam1,document.getElementById("madlv2").value=a.MaxLevDam2,document.getElementById("madlv3").value=a.MaxLevDam3,document.getElementById("madlv4").value=a.MaxLevDam4,document.getElementById("madlv5").value=a.MaxLevDam5,document.getElementById("dlen").value=0,document.getElementById("lenlv1").value=0,document.getElementById("lenlv2").value=0,document.getElementById("lenlv3").value=0):b&&(d.value=
a.EType,document.getElementById("mind").value=a.EMin,document.getElementById("midlv1").value=a.EMinLev1,document.getElementById("midlv2").value=a.EMinLev2,document.getElementById("midlv3").value=a.EMinLev3,document.getElementById("midlv4").value=a.EMinLev4,document.getElementById("midlv5").value=a.EMinLev5,document.getElementById("maxd").value=a.EMax,document.getElementById("madlv1").value=a.EMaxLev1,document.getElementById("madlv2").value=a.EMaxLev2,document.getElementById("madlv3").value=a.EMaxLev3,
document.getElementById("madlv4").value=a.EMaxLev4,document.getElementById("madlv5").value=a.EMaxLev5,document.getElementById("dlen").value=a.ELen,document.getElementById("lenlv1").value=a.ELevLen1,document.getElementById("lenlv2").value=a.ELevLen2,document.getElementById("lenlv3").value=a.ELevLen3);var e=[document.getElementById("mind").value,document.getElementById("midlv1").value,document.getElementById("midlv2").value,document.getElementById("midlv3").value,document.getElementById("midlv4").value,
document.getElementById("midlv5").value,document.getElementById("maxd").value,document.getElementById("madlv1").value,document.getElementById("madlv2").value,document.getElementById("madlv3").value,document.getElementById("madlv4").value,document.getElementById("madlv5").value,document.getElementById("dlen").value,document.getElementById("lenlv1").value,document.getElementById("lenlv2").value,document.getElementById("lenlv3").value];a=calcSkillDamage(d.value,parseInt(f),a.HitShift,parseInt(g),e);
document.getElementById("totaldmg").innerText=a.min+" ~ "+a.max;document.getElementById("totaldmglen").innerText=a.len/25+" /s";switch(d.value){case "phys":document.getElementById("totaldmg").setAttribute("class","ctext dColorPhys");document.getElementById("totaldmglen").setAttribute("class","ctext dColorPhys");break;case "fire":document.getElementById("totaldmg").setAttribute("class","ctext dColorFire");document.getElementById("totaldmglen").setAttribute("class","ctext dColorFire");break;case "ltng":document.getElementById("totaldmg").setAttribute("class",
"ctext dColorLtng");document.getElementById("totaldmglen").setAttribute("class","ctext dColorLtng");break;case "mag":document.getElementById("totaldmg").setAttribute("class","ctext dColorMag");document.getElementById("totaldmglen").setAttribute("class","ctext dColorMag");break;case "cold":document.getElementById("totaldmg").setAttribute("class","ctext dColorCold");document.getElementById("totaldmglen").setAttribute("class","ctext dColorCold");break;case "pois":document.getElementById("totaldmg").setAttribute("class",
"ctext dColorPois");document.getElementById("totaldmglen").setAttribute("class","ctext dColorPois");break;default:document.getElementById("totaldmg").setAttribute("class","ctext ltheme"),document.getElementById("totaldmglen").setAttribute("class","ctext ltheme")}}
function calcSkillDamage(c,b,a,d,f){for(var g in f)f[g]=""==f[g]?0:parseInt(f[g]);a=""==a?0:parseInt(a);var e=$jscomp.makeIterator(f);f=e.next().value;g=e.next().value;var q=e.next().value,r=e.next().value,t=e.next().value,u=e.next().value,p=e.next().value,v=e.next().value,w=e.next().value,x=e.next().value,y=e.next().value,z=e.next().value,n=e.next().value,A=e.next().value,B=e.next().value;e=e.next().value;var l={min:0,max:0,len:0},h=0,k=0,m=0;a=8==a?1:7==a?.5:6==a?.25:5==a?.125:4==a?.0625:3==a?.03125:
2==a?.0078125:.00390625;8>=b?m=A*(b-1):8<b&&16>=b?m=B*(b-1):17<=b&&(m=e*(b-1));8>=b?(h=g*(b-1),k=v*(b-1)):8<b&&16>=b?(h=q*(b-1),k=w*(b-1)):16<b&&22>=b?(h=r*(b-1),k=x*(b-1)):22<b&&28>=b?(h=t*(b-1),k=y*(b-1)):29<=b&&(h=u*(b-1),k=z*(b-1));"pois"==c?(l.min=((f+h)*(n+m)/256*a*(1+d)).toFixed(2),l.max=((p+k)*(n+m)/256*a*(1+d)).toFixed(2)):(l.min=((f+h)*a*(1+d)).toFixed(2),l.max=((p+k)*a*(1+d)).toFixed(2));l.len=n+m;return l}
function handleTxt(c){readFile(c,function(b,a){var d=a.target.result;switch(b.target.files[0].name.toLowerCase()){case "skills.txt":if("skill\t"!=d.substring(0,6))return alert("This is not a valid Skills.txt");fSkills=txtLib.parse(d);break;default:return alert("This file is not supported.")}fSkills&&(document.getElementById("upload").style.display="none",document.getElementById("editable").style.display="inline-block",fillSkills(),doSkillCalc(0))})}
function initialize(){document.getElementById("skillsf").addEventListener("change",handleTxt,!1);document.getElementById("sklvl").addEventListener("keyup",handleCalcInp,!1);document.getElementById("syndmg").addEventListener("keyup",handleCalcInp,!1);document.getElementById("dtypes").addEventListener("mouseup",handleCalcInp,!1);document.getElementById("mind").addEventListener("keyup",handleCalcInp,!1);document.getElementById("midlv1").addEventListener("keyup",handleCalcInp,!1);document.getElementById("midlv2").addEventListener("keyup",
handleCalcInp,!1);document.getElementById("midlv3").addEventListener("keyup",handleCalcInp,!1);document.getElementById("midlv4").addEventListener("keyup",handleCalcInp,!1);document.getElementById("midlv5").addEventListener("keyup",handleCalcInp,!1);document.getElementById("maxd").addEventListener("keyup",handleCalcInp,!1);document.getElementById("madlv1").addEventListener("keyup",handleCalcInp,!1);document.getElementById("madlv2").addEventListener("keyup",handleCalcInp,!1);document.getElementById("madlv3").addEventListener("keyup",
handleCalcInp,!1);document.getElementById("madlv4").addEventListener("keyup",handleCalcInp,!1);document.getElementById("madlv5").addEventListener("keyup",handleCalcInp,!1);document.getElementById("dlen").addEventListener("keyup",handleCalcInp,!1);document.getElementById("lenlv1").addEventListener("keyup",handleCalcInp,!1);document.getElementById("lenlv2").addEventListener("keyup",handleCalcInp,!1);document.getElementById("lenlv3").addEventListener("keyup",handleCalcInp,!1)};
